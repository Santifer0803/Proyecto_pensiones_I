---
title: "Contexto_economico"
author: "Alejandro Brenes, Santiago Fernández, Eyeri Méndez y Erik Venegas"
date: "`r Sys.Date()`"
output: html_document
---

Se cargan las librerías necesarias.

```{r librerias}
pacman::p_load(dplyr,
               ggplot2,
               readxl)
```

## Inflación

```{r inflacion_cr}
#Se cargan los datos
inflacion <- read_excel("data/API_FP.CPI.TOTL.ZG_DS2_es_excel_v2_76102.xls")
View(API_FP_CPI_TOTL_ZG_DS2_es_excel_v2_76102)

#Se filtran para tener solo lo de Costa Rica
inflacion_cr <- inflacion %>%
  filter(`Data Source` %in% c("Costa Rica", "Country Name"))

inflacion_cr <- inflacion_cr[, -c(2,3, 4)]
inflacion_cr[1, 1] <- "Año"

colnames(inflacion_cr) <- as.character(inflacion_cr[1, ])  

inflacion_cr <- as.data.frame(t(inflacion_cr))
colnames(inflacion_cr) <- as.character(inflacion_cr[1, ]) 
inflacion_cr <- inflacion_cr[-1, ]

#Se agrega el valor de 2024

inflacion_2024 <- data.frame("Año" = 2024, "Costa Rica" = 0.84)
colnames(inflacion_2024) <- colnames(inflacion_cr)
inflacion_cr <- rbind(inflacion_cr, inflacion_2024)

# se reasignan las filas con numeración normal (1, 2, 3, ...)
row.names(inflacion_cr) <- NULL

# Se pasan las columnas a numérico
inflacion_cr <- inflacion_cr %>%
  mutate(across(c(1, 2), as.numeric))

#gráfico
ggplot(inflacion_cr, aes(x = Año, y = `Costa Rica`)) +
  geom_line(color = "blue") + 
  geom_point(color = "darkblue", size = 1.5) +
  labs(title = "Inflación en % anual de Costa Rica", x = "Año", y = "Inflación") +
  theme_minimal()

```




## Tasas de interés

```{r}

```

## Producto Interno Bruto

Se busca hacer un gráfico representando el PIB de Costa Rica, por lo cual es necesario cargar los datos, dejar el país requerido y los años correspondientes.

```{r PIB_CR}
# Se guarda la base
bd.pib <- read_excel("data/PIB_CR.xlsx")

# Se filtra por Costa Rica
bd.pib <- bd.pib %>% filter(`Country Name` == "Costa Rica")

# Se crea el nuevo DataFrame
bd.pib <- data.frame(annos = 1995:2024,
                     pib = c(unlist(unname(bd.pib[, 40:68])), 42755147159722) / 1000000000)

# Gráfico del PIB en Costa Rica desde 1995 hasta 2023
ggplot(data = bd.pib, aes(x = annos, y = pib)) +
  geom_line(color = "chartreuse3", linewidth = 1) +
  geom_point(color = "chartreuse4", size = 1.5) +
  labs(x = "Año", y = "PIB en billones de colones", caption = "Fuente: elaboración propia") +
  theme_minimal()
```

## Variación de salarios

```{r}

```




